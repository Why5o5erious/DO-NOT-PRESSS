<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Do Not Press</title>

  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
    }

    button {
      width: 220px;
      height: 220px;
      border-radius: 50%;
      background: red;
      color: white;
      font-size: 22px;
      font-weight: bold;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 35px rgba(255, 0, 0, 0.8);
    }

    #globalCounter {
      margin-top: 24px;
      font-size: 24px;
    }

    #message {
      margin-top: 12px;
      font-size: 18px;
      opacity: 0.85;
      max-width: 420px;
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>

<body>

  <button id="mainButton">DO NOT PRESS</button>

  <div id="globalCounter">Pressed globally: loading…</div>
  <div id="message">The internet cannot be trusted.</div>

<script>
/* -------------------- FIREBASE -------------------- */
firebase.initializeApp({
  apiKey: "AIzaSyCE-7BlU_HfYRIeGciR76o4I78DT0qRk6E",
  authDomain: "do-not-press-cbc0e.firebaseapp.com",
  projectId: "do-not-press-cbc0e"
});

const db = firebase.firestore();
const globalRef = db.collection("global").doc("stats");

// Ensure document exists
globalRef.set({ totalPresses: 0 }, { merge: true });

/* -------------------- ELEMENTS -------------------- */
const button = document.getElementById("mainButton");
const globalCounter = document.getElementById("globalCounter");
const message = document.getElementById("message");

/* -------------------- NORMAL MESSAGES -------------------- */
const normalMessages = [
  "Someone ignored the warning.",
  "That was unnecessary.",
  "Another press. Interesting choice.",
  "You didn’t have to do that.",
  "Curiosity won.",
  "Still pressing it.",
  "No one is stopping.",
  "This is why we can’t have nice things."
];

function pick(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

/* -------------------- MILESTONE LOGIC -------------------- */
function milestoneMessage(total) {
  // Every 1,000
  if (total % 1000 === 0 && total < 100000) {
    return `${total.toLocaleString()} presses. This is escalating.`;
  }

  // Major milestones
  if (total === 100000) return "100,000 presses. This stopped being funny.";
  if (total === 500000) return "500,000 presses. Half a million bad decisions.";
  if (total === 1000000) return "1,000,000 presses. One million. Sit with that.";
  if (total % 1000000 === 0 && total > 1000000) {
    return `${total / 1000000} million presses. No one learned anything.`;
  }

  return null;
}

/* -------------------- CLICK -------------------- */
button.addEventListener("click", async () => {
  try {
    await globalRef.update({
      totalPresses: firebase.firestore.FieldValue.increment(1)
    });
  } catch (e) {
    console.error("Firebase error", e);
  }
});

/* -------------------- LIVE GLOBAL LISTENER -------------------- */
globalRef.onSnapshot(doc => {
  if (!doc.exists) return;

  const total = doc.data().totalPresses;
  globalCounter.innerText =
    `Pressed globally: ${total.toLocaleString()} times`;

  const milestone = milestoneMessage(total);
  message.innerText = milestone ? milestone : pick(normalMessages);
});
</script>

</body>
</html>
